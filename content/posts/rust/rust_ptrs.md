+++
title = "Rust 学习笔记 | 智能指针"
date = "2023-05-11"
description = ""
tags = ["rust"]
categories = ["rust"]
toc = true
tocBorder = true
+++

## 需要了解的概念

- 指针（pointer）是一个包含内存地址的变量的通用概念，这个地址引用或指向了其他的数据。
- 智能指针（smart pointers）是一类类似指针的数据结构。
  但是拥有额外的元数据和功能，比如**引用计数**（reference counting）。
  引用计数可以表示该数据有多少个所有者。
- 普通引用和智能指针的区别：引用是**只借用**数据的指针。而智能指针一般**拥有**指向的数据。
- `String`和`Vec<T>`也算是智能指针，携带元数据（比如容量）。
  或者携带额外的功能或者保证（`String`数据总是有效的 UTF-8 编码）。

## 智能指针：堆指针`Box<T>`

Box<T>是最简单的智能指针，将数据放在堆（heap）上，
留在栈上的是指向堆数据的指针。

使用场景：
- 编译一个未知大小的类型，但是又不得不需要明确的大小；
- 大量数据转移所有权，但是不希望发生数据拷贝；
- 使用特定的`trait`作为变量，而不是具体类型。比如递归类型，理论上数据可以无限前套。
  所以 Rust 不知道递归类型需要多少空间。此时可以使用`Box<T>`来处理。

示例：
```rust
fn main() {
    let b = Box::new(5);
    println!("b={}", b);
}
```

## 智能指针：引用计数`Rc<T>`


## 解引用 Deref trait 介绍
